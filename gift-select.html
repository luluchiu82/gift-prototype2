<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>送出心意</title>
<style>
body {
  font-family: "Noto Sans TC", sans-serif;
  background-color: #f7f7f7;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}

header {
  position: relative;
  background-color: #ffffff;
  width: 100%;
  height: 100px;
  border-bottom: 1px solid #e0e0e0;
  display: flex;
  align-items: center;
  justify-content: center; /* 讓中央區塊置中 */
}

.back-btn {
  position: absolute; /* 固定在最左側，不影響中央置中 */
  left: 20px;
  background: none;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
  color: #3b653d;
}

.header-center {
  display: flex;
  flex-direction: column; /* 垂直排列 */
  align-items: center;
  justify-content: center;
  gap: 5px;
}

.header-center p {
  margin: 0;
  font-size: 1rem;
  color: #666;
}

.header-center img {
  width: 60px;
  height: auto;
}
  
main {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: start;
  width: 100%;
  padding: 20px;
}

svg {
  width: 85%;
  max-width: 400px;
  margin-top: 20px;
}

#text {
  margin-top: 20px;
  text-align: center;
  color: #555;
  font-size: 1rem;
  line-height: 1.6;
}

.btn-container {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 30px;
}

.btn {
  background-color: #6fb27b;
  color: white;
  padding: 12px 22px;
  border: none;
  border-radius: 12px;
  font-size: 1rem;
  cursor: pointer;
  transition: 0.3s;
}

.btn:hover {
  background-color: #5b9968;
}

footer {
  width: 100%;
  text-align: center;
  padding: 10px;
  font-size: 0.8rem;
  color: #888;
}
</style>
</head>

<body>
<header>
  <button class="back-btn" onclick="history.back()"><</button>
  <div class="header-center">
    <p>迷客夏</p>
    <img src="images/Milksha_logo.png" alt="迷點">
  </div>
</header>

<main>
  <!-- 台灣地圖 SVG -->
  <svg id="taiwan-map" viewBox="0 0 1000 1200" preserveAspectRatio="xMidYMid meet"></svg>
  <div id="text">
    今天你在的城市送出了 <strong>1,063</strong> 杯飲料，<br>
    送一杯飲料給你正在想的人吧！
  </div>

  <div class="btn-container">
    <button class="btn" onclick="location.href='choose-drink.html'">送飲料</button>
    <button class="btn" onclick="alert('此功能即將開放！')">送現金券</button>
  </div>
</main>

<footer>© 2025 Milksha 心意計畫</footer>
</body>
</html>


<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
// 台灣各縣市 GeoJSON 簡化版本 (為示例，只放幾個縣市)
const taiwanGeo = {
  "type": "FeatureCollection",
  "features": [
    { "type": "Feature", "properties": { "name": "台北市" }, "geometry": { "type": "Polygon", "coordinates": [[[480,100],[520,100],[520,140],[480,140],[480,100]]] } },
    { "type": "Feature", "properties": { "name": "新北市" }, "geometry": { "type": "Polygon", "coordinates": [[[450,150],[550,150],[550,200],[450,200],[450,150]]] } },
    { "type": "Feature", "properties": { "name": "高雄市" }, "geometry": { "type": "Polygon", "coordinates": [[[400,600],[600,600],[600,700],[400,700],[400,600]]] } }
    // 可以再加入其他縣市
  ]
};

// 範例數據：每個城市送出的飲料數量
const cityData = {
  "台北市": 1063,
  "新北市": 850,
  "高雄市": 430
};

// Morandi 色盤範例
const colorScale = d3.scaleLinear()
  .domain([0, 1100]) // 數據最小值~最大值
  .range(["#d6e0d6","#6fb27b"]); // 淺綠~主色

const width = document.getElementById("taiwan-map").clientWidth;
const height = width * 1.2; // 高度比例
const svg = d3.select("#taiwan-map")
  .attr("width", width)
  .attr("height", height);

const projection = d3.geoIdentity().reflectY(true).fitSize([width, height], taiwanGeo);
const path = d3.geoPath().projection(projection);

// 畫地圖
svg.selectAll("path")
  .data(taiwanGeo.features)
  .join("path")
  .attr("d", path)
  .attr("fill", d => colorScale(cityData[d.properties.name] || 0))
  .attr("stroke", "#6fa76e")
  .attr("stroke-width", 2)
  .on("mouseover", function(event,d){
    d3.select(this).attr("fill","#ef6f6f");
    tooltip.style("display","block").text(d.properties.name + ": " + (cityData[d.properties.name]||0) + " 杯");
  })
  .on("mousemove", function(event){
    tooltip.style("left",(event.pageX+10)+"px").style("top",(event.pageY+10)+"px");
  })
  .on("mouseout", function(event,d){
    d3.select(this).attr("fill", colorScale(cityData[d.properties.name] || 0));
    tooltip.style("display","none");
  });

// Tooltip
const tooltip = d3.select("body").append("div")
  .style("position","absolute")
  .style("background","#fff")
  .style("padding","6px 12px")
  .style("border-radius","6px")
  .style("box-shadow","0 2px 6px rgba(0,0,0,0.15)")
  .style("pointer-events","none")
  .style("display","none");
</script>
